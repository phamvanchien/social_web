"use client";
import { useEffect, useRef } from "react";

interface EmojiPickerProps {
  open: boolean;
  onClose: () => void;
  onSelect: (emoji: string) => void;
}

const emojiCategories = [
  {
    name: "Máº·t cÆ°á»i",
    emojis: ["ðŸ˜€", "ðŸ˜ƒ", "ðŸ˜„", "ðŸ˜", "ðŸ˜†", "ðŸ˜…", "ðŸ¤£", "ðŸ˜‚", "ðŸ™‚", "ðŸ˜Š", "ðŸ˜‡", "ðŸ¥°", "ðŸ˜", "ðŸ¤©", "ðŸ˜˜", "ðŸ˜—", "ðŸ˜š", "ðŸ˜™", "ðŸ¥²", "ðŸ˜‹", "ðŸ˜›", "ðŸ˜œ", "ðŸ¤ª", "ðŸ˜", "ðŸ¤‘", "ðŸ¤—", "ðŸ¤­", "ðŸ¤«", "ðŸ¤”", "ðŸ¤", "ðŸ¤¨", "ðŸ˜", "ðŸ˜‘", "ðŸ˜¶", "ðŸ˜", "ðŸ˜’", "ðŸ™„", "ðŸ˜¬", "ðŸ¤¥", "ðŸ˜Œ", "ðŸ˜”", "ðŸ˜ª", "ðŸ¤¤", "ðŸ˜´", "ðŸ˜·"]
  },
  {
    name: "Cáº£m xÃºc",
    emojis: ["ðŸ˜®", "ðŸ˜¯", "ðŸ˜²", "ðŸ˜³", "ðŸ¥º", "ðŸ˜¦", "ðŸ˜§", "ðŸ˜¨", "ðŸ˜°", "ðŸ˜¥", "ðŸ˜¢", "ðŸ˜­", "ðŸ˜±", "ðŸ˜–", "ðŸ˜£", "ðŸ˜ž", "ðŸ˜“", "ðŸ˜©", "ðŸ˜«", "ðŸ¥±", "ðŸ˜¤", "ðŸ˜¡", "ðŸ˜ ", "ðŸ¤¬", "ðŸ˜ˆ", "ðŸ‘¿", "ðŸ’€", "â˜ ï¸", "ðŸ’©", "ðŸ¤¡", "ðŸ‘¹", "ðŸ‘º", "ðŸ‘»", "ðŸ‘½", "ðŸ‘¾", "ðŸ¤–"]
  },
  {
    name: "Tim & TÃ¬nh yÃªu",
    emojis: ["â¤ï¸", "ðŸ§¡", "ðŸ’›", "ðŸ’š", "ðŸ’™", "ðŸ’œ", "ðŸ–¤", "ðŸ¤", "ðŸ¤Ž", "ðŸ’”", "â£ï¸", "ðŸ’•", "ðŸ’ž", "ðŸ’“", "ðŸ’—", "ðŸ’–", "ðŸ’˜", "ðŸ’", "ðŸ’Ÿ", "â™¥ï¸", "ðŸ’‹", "ðŸ’Œ", "ðŸ’", "ðŸŒ¹", "ðŸ¥€", "ðŸŒ·", "ðŸŒ¸", "ðŸ’®", "ðŸµï¸", "ðŸŒ»", "ðŸŒ¼"]
  },
  {
    name: "Cá»­ chá»‰",
    emojis: ["ðŸ‘", "ðŸ‘Ž", "ðŸ‘Š", "âœŠ", "ðŸ¤›", "ðŸ¤œ", "ðŸ‘", "ðŸ™Œ", "ðŸ‘", "ðŸ¤²", "ðŸ¤", "ðŸ™", "âœŒï¸", "ðŸ¤ž", "ðŸ¤Ÿ", "ðŸ¤˜", "ðŸ¤™", "ðŸ‘ˆ", "ðŸ‘‰", "ðŸ‘†", "ðŸ‘‡", "â˜ï¸", "âœ‹", "ðŸ¤š", "ðŸ–ï¸", "ðŸ––", "ðŸ‘‹", "ðŸ¤", "âœï¸", "ðŸ¦¾", "ðŸ’ª"]
  },
  {
    name: "Äá»™ng váº­t",
    emojis: ["ðŸ¶", "ðŸ±", "ðŸ­", "ðŸ¹", "ðŸ°", "ðŸ¦Š", "ðŸ»", "ðŸ¼", "ðŸ¨", "ðŸ¯", "ðŸ¦", "ðŸ®", "ðŸ·", "ðŸ¸", "ðŸµ", "ðŸ™ˆ", "ðŸ™‰", "ðŸ™Š", "ðŸ”", "ðŸ§", "ðŸ¦", "ðŸ¤", "ðŸ¦†", "ðŸ¦…", "ðŸ¦‰", "ðŸ¦‡", "ðŸº", "ðŸ—", "ðŸ´", "ðŸ¦„", "ðŸ", "ðŸ¦‹"]
  },
  {
    name: "Äá»“ Äƒn",
    emojis: ["ðŸŽ", "ðŸ", "ðŸŠ", "ðŸ‹", "ðŸŒ", "ðŸ‰", "ðŸ‡", "ðŸ“", "ðŸ«", "ðŸˆ", "ðŸ’", "ðŸ‘", "ðŸ¥­", "ðŸ", "ðŸ¥¥", "ðŸ¥", "ðŸ…", "ðŸ¥‘", "ðŸ”", "ðŸŸ", "ðŸ•", "ðŸŒ­", "ðŸ¥ª", "ðŸŒ®", "ðŸœ", "ðŸ", "ðŸ£", "ðŸ±", "ðŸ©", "ðŸª", "ðŸŽ‚", "ðŸ°"]
  },
  {
    name: "Hoáº¡t Ä‘á»™ng",
    emojis: ["âš½", "ðŸ€", "ðŸˆ", "âš¾", "ðŸ¥Ž", "ðŸŽ¾", "ðŸ", "ðŸ‰", "ðŸ¥", "ðŸŽ±", "ðŸ“", "ðŸ¸", "ðŸ’", "ðŸ¥…", "â›³", "ðŸ¹", "ðŸŽ£", "ðŸ¥Š", "ðŸ¥‹", "ðŸŽ¿", "â›·ï¸", "ðŸ‚", "ðŸ‹ï¸", "ðŸš´", "ðŸŠ", "ðŸ§˜", "ðŸŽ®", "ðŸŽ¯", "ðŸŽ²", "ðŸŽª", "ðŸŽ­", "ðŸŽ¨"]
  },
  {
    name: "Du lá»‹ch",
    emojis: ["ðŸš—", "ðŸš•", "ðŸšŒ", "ðŸšŽ", "ðŸŽï¸", "ðŸš“", "ðŸš‘", "ðŸš’", "ðŸš", "ðŸ›»", "ðŸšš", "ðŸš›", "ðŸšœ", "âœˆï¸", "ðŸš€", "ðŸ›¸", "ðŸš", "ðŸ›¶", "â›µ", "ðŸš¤", "ðŸ›³ï¸", "ðŸ—¼", "ðŸ—½", "ðŸ°", "ðŸ¯", "ðŸŸï¸", "ðŸŽ¡", "ðŸŽ¢", "ðŸŒ‹", "ðŸï¸", "ðŸ–ï¸", "â›±ï¸"]
  }
];

const EmojiPicker = ({ open, onClose, onSelect }: EmojiPickerProps) => {
  const ref = useRef<HTMLDivElement>(null);

  useEffect(() => {
    const handleClickOutside = (event: MouseEvent) => {
      if (ref.current && !ref.current.contains(event.target as Node)) {
        onClose();
      }
    };

    if (open) {
      document.addEventListener("mousedown", handleClickOutside);
    }

    return () => {
      document.removeEventListener("mousedown", handleClickOutside);
    };
  }, [open, onClose]);

  if (!open) return null;

  return (
    <div
      ref={ref}
      className="absolute bottom-full right-0 mb-2 w-[320px] bg-white rounded-xl shadow-lg border border-gray-200 z-50"
    >
      <div className="p-2 max-h-[300px] overflow-y-auto">
        {emojiCategories.map((category) => (
          <div key={category.name} className="mb-3">
            <div className="text-[12px] font-medium text-gray-500 px-1 mb-1">
              {category.name}
            </div>
            <div className="grid grid-cols-8 gap-0.5">
              {category.emojis.map((emoji, index) => (
                <button
                  key={index}
                  type="button"
                  className="w-8 h-8 flex items-center justify-center text-xl hover:bg-gray-100 rounded transition"
                  onClick={() => {
                    onSelect(emoji);
                  }}
                >
                  {emoji}
                </button>
              ))}
            </div>
          </div>
        ))}
      </div>
    </div>
  );
};

export default EmojiPicker;
